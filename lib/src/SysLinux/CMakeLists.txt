FIND_PATH( DBUS_INCLUDE_DIR
dbus-1.0/dbus/dbus-shared.h
PATHS ${CMAKE_INCLUDE_PATH}
)

FIND_PATH( DBUS_CPP_INCLUDE_DIR
dbus-c++-1/dbus-c++/dbus.h
PATHS ${CMAKE_INCLUDE_PATH}
)

FIND_PATH( NETWORK_MANAGER_INCLUDE_DIR
NetworkManager/NetworkManager.h
PATHS ${CMAKE_INCLUDE_PATH}
)

FIND_LIBRARY(LIB_DBUS_CPP
NAME dbus-c++-1
PATHS ${CMAKE_LIBRARY_PATH}
)

FIND_PATH(POCO_INCLUDE_DIR
Poco/Poco.h
PATHS ${CMAKE_INCLUDE_PATH}
)

FIND_LIBRARY(LIB_POCO_FOUNDATION
NAME PocoFoundation
PATHS ${CMAKE_LIBRARY_PATH}
)

if(DBUS_INCLUDE_DIR AND DBUS_CPP_INCLUDE_DIR AND NETWORK_MANAGER_INCLUDE_DIR AND LIB_DBUS_CPP AND POCO_INCLUDE_DIR AND LIB_POCO_FOUNDATION)
message(STATUS "dbus found in " ${DBUS_INCLUDE_DIR})
message(STATUS "dbus-c++-1 found in " ${DBUS_CPP_INCLUDE_DIR})
message(STATUS "NetworkManager headers found in " ${NETWORK_MANAGER_INCLUDE_DIR})
message(STATUS "Poco headers found in " ${POCO_INCLUDE_DIR})

INCLUDE_DIRECTORIES(
${DBUS_INCLUDE_DIR}
${DBUS_CPP_INCLUDE_DIR}
${NETWORK_MANAGER_INCLUDE_DIR}
${POCO_INCLUDE_DIR}
${ommlib_SOURCE_DIR}/Omm
)

ADD_LIBRARY( ommsys-linux
    SHARED
    SysImplLinux.cpp
    NetworkDevice.cpp
)

TARGET_LINK_LIBRARIES( ommsys-linux
    ${LIB_POCO_FOUNDATION}
    ${LIB_DBUS_CPP}
)

INSTALL( TARGETS ommsys-linux
LIBRARY DESTINATION lib
ARCHIVE DESTINATION lib
)

else(DBUS_INCLUDE_DIR AND DBUS_CPP_INCLUDE_DIR AND NETWORK_MANAGER_INCLUDE_DIR AND LIB_DBUS_CPP AND POCO_INCLUDE_DIR AND LIB_POCO_FOUNDATION)
if(NOT ${DBUS_INCLUDE_DIR})
message(STATUS "dbus not found")
endif(NOT ${DBUS_INCLUDE_DIR})
if(NOT ${DBUS_CPP_INCLUDE_DIR})
message(STATUS "dbus-c++-1 not found")
endif(NOT ${DBUS_CPP_INCLUDE_DIR})
if(NOT ${NETWORK_MANAGER_INCLUDE_DIR})
message(STATUS "NetworkManager not found")
endif(NOT ${NETWORK_MANAGER_INCLUDE_DIR})
if(NOT (${POCO_INCLUDE_DIR} AND ${LIB_POCO_FOUNDATION))
message(STATUS "Poco not found")
endif(NOT (${POCO_INCLUDE_DIR} AND ${LIB_POCO_FOUNDATION))
endif(DBUS_INCLUDE_DIR AND DBUS_CPP_INCLUDE_DIR AND NETWORK_MANAGER_INCLUDE_DIR AND LIB_DBUS_CPP AND POCO_INCLUDE_DIR AND LIB_POCO_FOUNDATION)
