#! /bin/sh /usr/share/vdr-dev/make-special-vdr.sh

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/rules/dpatch.mk

DEB_INSTALL_CHANGELOGS_ALL = HISTORY

MAKE_OPTIONS = DVBDIR=/usr VDRDIR=/usr/include/vdr LIBDIR=.

common-build-arch::
	$(MAKE) all $(MAKE_OPTIONS)
	cp streamdevhosts.conf.example streamdevhosts.conf

clean::
	$(MAKE) -o .dependencies clean $(MAKE_OPTIONS)
	rm -f libvdr-*.so.*
	rm -f streamdevhosts.conf

common-binary-predeb-arch::
	sh /usr/share/vdr-dev/patchlevel.sh subst
	sh /usr/share/vdr-dev/dependencies.sh

VERSION_DATE = $(shell /bin/date --utc +%0Y%0m%0d.%0k%0M)
VERSION_ID = 0.3.3~cvs$(VERSION_DATE)
get-orig-source::
	echo Downloading vdr-streamdev $(VERSION_ID) from cvs...
	cvs -d:pserver:anoncvs@vdr-developer.org:/var/cvsroot co streamdev
	rm -rf `find streamdev -type d -name CVS`
	tar cvfz "../vdr-plugin-streamdev_$(VERSION_ID).orig.tar.gz" streamdev
	rm -rf streamdev
	dch -v "$(VERSION_ID)-1" "New Upstream Snapshot"
